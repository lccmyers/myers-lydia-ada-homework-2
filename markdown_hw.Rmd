---
title: "myers-lydia-ada-hw-2"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Challenge 1

Loading packages and data


```{r,results='hide'}
library(tidyverse)
library(mosaic)
library(gridExtra)
d<-read_csv("https://raw.githubusercontent.com/difiore/ada-2021-datasets/master/IMDB-movies.csv",col_names=T)
```

Filtering data

```{r}
d<-filter(d, startYear %in% 1920:1979  & runtimeMinutes %in% 60:180)
d<-mutate(d, "decade"=paste(10*as.integer(as.numeric(substring(as.character(d$startYear), 3, 4)) / 10)))
head(d)
```

Plotting histograms

```{r}
ggplot(d, aes(x=runtimeMinutes)) + geom_histogram(bins=10)+
  facet_wrap(~decade,scales='free_x')
```

Calculating mean and sd

```{r}
print(results <- summarise((group_by(d,decade)), avg = mean(runtimeMinutes, na.rm = T), 
  sd=sd(runtimeMinutes,na.rm=T)))
```
Creating a sample, estimating sample mean, standard deviation, and standard error

```{r}
set.seed(100)
print(sample <- d %>% group_by(decade) %>% sample_n(100,replace=F)%>%
  summarise(sampleMean=mean(runtimeMinutes,na.rm=T),
      sampleSD=sd(runtimeMinutes,na.rm=T)))
print(se_mean <- sample$sampleMean/(sqrt(100)))
```
Comparison... the sampling seems to have been accurate, and the standard error seems to be accurate as well
```{r}
sample
results
se_mean
```
#creating sample distribution and calculating mean and standard deviation of each sample
```{r}
sample_dist<-do(1000) * d %>% group_by(decade) %>% sample_n(100,replace=F)%>%
  summarise(sampleMean=mean(runtimeMinutes,na.rm=T),
            sampleSD=sd(runtimeMinutes,na.rm=T))
```
Calculating the mean and standard deviation of the sampling distribution
```{r}
mean(sample_dist$sampleMean)
sd(sample_dist$sampleSD)
```
Plotting the histogram
```{r}
hist(sample_dist$sampleMean,main="Sample Distribution",xlab="Mean")
```
The distribution is somewhat normal, not exactly but close

Standard error of mean for first sample
```{r}
se_mean
```
Standard error of known population standard deviations for each decade
```{r}
results$sd/(sqrt(5651))
```
Standard error as esitmated from sampling distribution of sample means
```{r,results='hide'}
sample_dist$sampleMean/sqrt(100)
```

## Challenge 2

What is the probability that she will see 9 or fewer bees arrive during any given session?
```{r}
l <- 12
ppois(9,l)
```
What is the probability that she will see no bees arrive in a session?
```{r}
ppois(0,l)
```
What is the probability that she will see exactly 5 bees arrive in a session?
```{r}
dpois(5,l)
```
What is the probability that she will see more than 18 bees arrive in a session?
```{r}
ppois(19,l,lower.tail=F)
```
Plot the relevant Poisson mass function over the values in range 0 ≤  x ≤ 24.
```{r}
x<-c(0:24)
plot(x,dpois(x,l),type='h',main="Poisson Distribution w/lambda = 12")
```
Using the rpois() function, simulate 1460 results 
from this distribution (i.e., 4 full years of morning monitoring sessions).
```{r}
r<-rpois(1460,l)
```
Plot the simulated results using the histogram() function from the 
{mosaic} package and use xlim() to set the horizontal limits to be from 0 to 24. 
How do your simulated results compare to the shape of the probability mass function you plotted above?
```{r}
histogram(r,xlim(0,24))
```
My results are pretty much the same as the probability mass function I plotted above.

## Challenge 3

Loading in data
```{r}
d<-read_csv("https://raw.githubusercontent.com/difiore/ada-2021-datasets/master/zombies.csv",col_names=T)
head(d)
```
Getting mean and sd
```{r}
colMeans(d[ , c(5, 6,7,8,10)])
n<-1000
popSD<-function(x){sqrt((n-1)/n) * sd(x)}
apply(d[ , c(5, 6,7,8,10)], 2, popSD)
```
Boxplots
```{r}
p1<-ggplot(d, aes(x=gender, y=height)) + 
  geom_boxplot()
p2<-ggplot(d, aes(x=gender, y=weight)) + 
  geom_boxplot()
p3<-ggplot(d, aes(x=gender, y=zombies_killed)) + 
  geom_boxplot()
p4<-ggplot(d, aes(x=gender, y=years_of_education)) + 
  geom_boxplot()
p5<-ggplot(d,aes(x=gender, y=age)) +
  geom_boxplot()

grid.arrange(p1, p2,p3,p4,p5, nrow=2, ncol=3)
```
Scatterplots
```{r}
p1<-ggplot(d, aes(x=height, y=age,color=gender)) + geom_point()
p2<-ggplot(d, aes(x=weight, y=age, color=gender)) + geom_point()

grid.arrange(p1,p2,nrow=2)
```
Height seems more correlated than weight with age - seems to be a direct relationship
```{r}
p1<-ggplot(d, aes(x=height)) +geom_histogram(binwidth=2, color="black", fill="turquoise4")
p2<-ggplot(d, aes(x=weight)) +geom_histogram(binwidth=2, color="black", fill="turquoise4")
p3<-ggplot(d, aes(x=zombies_killed)) +geom_histogram(binwidth=2, color="black", fill="turquoise4")
p4<-ggplot(d, aes(x=years_of_education)) +geom_histogram(binwidth=2, color="black", fill="turquoise4")
p5<-ggplot(d, aes(x=age)) +geom_histogram(binwidth=2, color="black", fill="turquoise4")

grid.arrange(p1, p2,p3,p4,p5, nrow=2, ncol=3)
```
q-q plots
```{r}
qqnorm(d$height, main = "Height")
qqline(d$height, col = "red")

qqnorm(d$weight, main = "Weight")
qqline(d$weight, col = "red")

qqnorm(d$zombies_killed, main = "Zombies Killed")
qqline(d$zombies_killed, col = "red")

qqnorm(d$years_of_education, main = "Years of Education")
qqline(d$years_of_education, col = "red")

qqnorm(d$age, main = "Age")
qqline(d$age, col = "red")
```
It looks like all but zombies killed and years of education are normally distributed

Taking a sample
```{r}
set.seed(50)
sample <- d %>% sample_n(50,replace=F)
```
Mean, SD, SE of each variable
```{r}
print(means<-colMeans(sample[ ,c(5,6,7,8,10)]))
print(sds<-apply(sample[ , c(5, 6,7,8,10)], 2, sd))
print(se_mean <- means/(sqrt(50)))
print(se_sds<-sds/(sqrt(50)))
```
Getting confidence intervals
```{r}
error<- qnorm(.975)*sds/sqrt(50)
print(lower<-means-error)
print(upper<-means+error)
```
Drawing another 99 samples
```{r}
sample_dist<-do(50) * d %>%sample_n(50,replace=F) 
m<-aggregate(.~.index, data=sample_dist[ ,c(5,6,7,8,10,12)], mean)
standev<-aggregate(.~.index, data=sample_dist[ ,c(5,6,7,8,10,12)], sd)
print(means<-colMeans(m[ ,c(2,3,4,5,6)]))
print(sds<-apply(m[ , c(2,3,4,5,6)], 2, sd))
```
Confidence intervals
```{r}
error<- qnorm(.975)*sds/sqrt(50)
print(lower_dist<-means-error)
print(upper_dist<-means+error)
```

```{r}
sds
se_sds
```
The standard deviations from the sampling distribution are  much smaller than the standard errors I calculated in my first sample

```{r}
p1<-ggplot(sample_dist, aes(x=height)) +geom_histogram(binwidth=1, color="black", fill="turquoise4")
p2<-ggplot(sample_dist, aes(x=weight)) +geom_histogram(binwidth=1, color="black", fill="turquoise4")
p3<-ggplot(sample_dist, aes(x=zombies_killed)) +geom_histogram(binwidth=1, color="black", fill="turquoise4")
p4<-ggplot(sample_dist, aes(x=years_of_education)) +geom_histogram(binwidth=1, color="black", fill="turquoise4")
p5<-ggplot(sample_dist, aes(x=age)) +geom_histogram(binwidth=1, color="black", fill="turquoise4")


grid.arrange(p1, p2,p3,p4,p5, nrow=2, ncol=3)
```
They're all normally distributed except zombies killed and years of education, which are left skewed
```{r}
upper
upper_dist
lower
lower_dist
```
The CIs are very similar to each other

